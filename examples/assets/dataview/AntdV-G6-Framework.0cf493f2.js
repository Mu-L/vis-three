import"../common.006007ed.js";import{D as K}from"../three.1b4256b1.js";import{C as F,D as U,g as i,E as l}from"../Vis.es.dd28f8ae.js";import{r as X,a as Z,i as ee,G as Y}from"../G6.4f29b8d2.js";import{v as te}from"../vis-three.72224a55.js";import"../Antd.5c304842.js";const ae={A:"#9CFC72",B:"#44A5FF",C:"#FFBE4C"},ne={nodes:[{id:"1",label:"Company1"},{id:"2",label:"Company2"},{id:"3",label:"Company3"},{id:"4",label:"Company4"},{id:"5",label:"Company5"},{id:"8",label:"Company8"},{id:"9",label:"Company9"}],edges:[{source:"1",target:"2",data:{type:"A",amount:"100,000 Yuan",date:"2019-08-03"}},{source:"1",target:"3",data:{type:"B",amount:"100,000 Yuan",date:"2019-08-03"}},{source:"2",target:"5",data:{type:"C",amount:"100,000 Yuan",date:"2019-08-03"}},{source:"3",target:"4",data:{type:"C",amount:"100,000 Yuan",date:"2019-08-03"}},{source:"1",target:"8",data:{type:"B",amount:"100,000 Yuan",date:"2019-08-03"}},{source:"1",target:"9",data:{type:"C",amount:"100,000 Yuan",date:"2019-08-03"}}]};X("round-rect",{drawShape:function(t,o){const n=t.style.width,a=t.style.stroke,c=o.addShape("rect",{attrs:{x:-n/2,y:-15,width:n,height:30,radius:15,stroke:a,lineWidth:3,fillOpacity:1},name:"rect-shape"});return o.addShape("circle",{attrs:{x:-n/2,y:0,r:3,fill:a},name:"circle-shape"}),o.addShape("circle",{attrs:{x:n/2,y:0,r:3,fill:a},name:"circle-shape2"}),c},getAnchorPoints:function(){return[[0,.5],[1,.5]]},update:function(t,o){const a=o.getContainer().get("children"),c=a[0],m=a[1],p=a[2],g=t.style.stroke;g&&(c.attr("stroke",g),m.attr("fill",g),p.attr("fill",g))}},"single-node");Z("fund-polyline",{itemType:"edge",draw:function(t,o){const n=t.startPoint,a=t.endPoint,c=a.y-n.y,m=c!==0?Math.min(500/Math.abs(c),20):0,p=m>15?0:16,g=c<0?p:-p,y={x:n.x+m,y:a.y+g},u={x:y.x+p,y:a.y},k={x:(y.x-n.x)*(a.y-n.y)/(y.y-n.y)+n.x,y:a.y};let z=[["M",n.x,n.y],["L",y.x,y.y],["Q",k.x,k.y,u.x,u.y],["L",a.x,a.y]];Math.abs(c)<=5&&(z=[["M",n.x,n.y],["L",a.x,a.y]]);const P=(t==null?void 0:t.style)&&t.style.endArrow?t.style.endArrow:!1;ee(P)&&(P.fill=stroke);const O=o.addShape("path",{attrs:{path:z,stroke:ae[t.data&&t.data.type],lineWidth:3,endArrow:P},name:"path-shape"}),b=0,A=8,J=o.addShape("text",{attrs:{text:t.data&&t.data.amount,x:u.x+b,y:a.y-A-2,fontSize:14,textAlign:"left",textBaseline:"middle",fill:"white"},name:"text-shape-amount"});return o.addShape("text",{attrs:{text:t.data&&t.data.type,x:u.x+b,y:a.y-A-J.getBBox().height-2,fontSize:10,textAlign:"left",textBaseline:"middle",fill:"white"},name:"text-shape-type"}),o.addShape("text",{attrs:{text:t.data&&t.data.date,x:u.x+b,y:a.y+A+4,fontSize:12,fontWeight:300,textAlign:"left",textBaseline:"middle",fill:"white"},name:"text-shape-date"}),O}});const v=document.createElement("div");v.style.width="1024px";v.style.height="1024px";v.style.position="absolute";v.style.opacity=0;v.className="g6-tree";document.body.appendChild(v);const I=new Y({container:v,layout:{type:"dagre",rankdir:"LR",nodesep:30,ranksep:100},fitView:!0,modes:{default:["drag-canvas"]},defaultNode:{type:"round-rect",labelCfg:{style:{fill:"white",fontSize:10}},style:{stroke:"#72CC4A",width:150}},defaultEdge:{type:"fund-polyline"}});I.data(ne);I.render();const G=["rgb(91, 143, 249)","rgb(90, 216, 166)","rgb(93, 112, 146)","rgb(246, 189, 22)","rgb(232, 104, 74)","rgb(109, 200, 236)","rgb(146, 112, 202)","rgb(255, 157, 77)","rgb(38, 154, 153)","rgb(227, 137, 163)"],x=document.createElement("div");x.style.width="1024px";x.style.height="1024px";x.style.position="absolute";x.style.opacity=0;x.className="g6-tree";document.body.appendChild(x);const h=new Y({container:x,linkCenter:!0,fitView:!0,modes:{default:[{type:"edge-tooltip",formatText:function(t){return"source: "+t.sourceName+"<br/> target: "+t.targetName}}]},defaultNode:{style:{opacity:.8,lineWidth:1,stroke:"#999"}},defaultEdge:{size:1,color:"#e2e2e2",style:{opacity:.6,lineAppendWidth:3}}});h.on("edge:mouseenter",function(e){const t=e.item;h.setItemState(t,"hover",!0)});h.on("edge:mouseleave",function(e){const t=e.item;h.setItemState(t,"hover",!1)});const se=1024,$=1024;fetch("https://gw.alipayobjects.com/os/basement_prod/70cde3be-22e8-4291-98f1-4d5a5b75b62f.json").then(e=>e.json()).then(e=>{const t=e.edges,o=e.nodes,n=new Map,a=new Map;let c=0;const m=o.length,p=10,g=[p,$*.7],y=[se-p,$*.7],u=y[0]-g[0],k=y[1]-g[1],z=u/m,P=k/m;o.forEach(function(s,C){s.x=g[0]+C*z,s.y=g[1]+C*P,n.set(s.id,s),s.cluster&&a.get(s.cluster)===void 0&&(a.set(s.cluster,c),c++);const N=a.get(s.cluster);s.style?s.style.fill=G[N%G.length]:s.style={fill:G[N%G.length]},s.label=s.name,s.labelCfg={position:"bottom",offset:5,style:{rotate:Math.PI/2,textAlign:"start",fill:"white"}}}),t.forEach(s=>{s.type="arc";const C=n.get(s.source),N=n.get(s.target),W=(N.x-C.x)/z,q=(W<0?-1:1)*10*Math.ceil(Math.abs(W));s.curveOffset=q,s.color=C.style.fill,s.sourceName=C.name,s.targetName=N.name});let O=-9999,b=9999;o.forEach(function(s){O<s.value&&(O=s.value),b>s.value&&(b=s.value)}),oe(o,"size","value",[b,O],[3,25]),h.data(e),h.render(),typeof window!="undefined"&&(window.onresize=()=>{!h||h.get("destroyed")||!container||!container.scrollWidth||!container.scrollHeight||h.changeSize(container.scrollWidth,container.scrollHeight)})});function oe(e,t,o,n,a){const c=a[1]-a[0],m=n[1]-n[0];e.forEach(function(p){p[t]=(p[o]-n[0])*c/m+a[0]})}const ie=new F({width:512,height:256,bgColor:"rgb(0, 0, 0)"}).draw(e=>{e.textBaseline="middle",e.textAlign="center",e.fillStyle="rgb(0, 255, 0)",e.font=" bold 54px \u5FAE\u8F6F\u96C5\u9ED1",e.fillText("\u6811\u67B6\u6784\u56FE\u8C31",256,128)}),re=new F({width:512,height:256,bgColor:"rgb(0, 0, 0)"}).draw(e=>{e.textBaseline="middle",e.textAlign="center",e.fillStyle="rgb(0, 255, 0)",e.font=" bold 54px \u5FAE\u8F6F\u96C5\u9ED1",e.fillText("\u98DE\u7EBF\u67B6\u6784\u56FE\u8C31",256,128)}),le=new F({width:256,height:256,bgColor:"rgb(0, 0, 0)"}).draw(e=>{const t=e.createLinearGradient(0,0,0,256);t.addColorStop(0,"rgb(0, 0, 255)"),t.addColorStop(1,"rgb(0, 100, 0)"),e.fillStyle=t,e.fillRect(0,0,256,256)}),S=new U().install("CSS3DRenderer").complete().setDom(document.getElementById("app")).setSize();S.registerResources({hookAlpha:le.getDom(),treeGraph:I.get("canvas").cfg.el,arcGraph:h.get("canvas").cfg.el,treeTips:ie.getDom(),arcTips:re.getDom()});i.injectEngine=S;const ce=i("PerspectiveCamera",{far:1e4,position:{x:500,y:-300,z:500}});S.setCamera(ce.vid).setSize();const de=i("Scene");S.setScene(de.vid);i.injectScene=!0;i("AmbientLight");const R=70,w=70,r=R/2,d=10,f=w*2,pe=i("CustomGeometry",{attribute:{position:[-r,0,-r,r,0,-r,r,0,r,-r,0,r,-r*d,f,-r*d,r*d,f,-r*d,r*d,f,r*d,-r*d,f,r*d],uv:[0,0,0,0,0,0,0,0,0,1,0,1,0,1,0,1],index:[0,4,5,5,1,0,1,5,6,6,2,1,2,6,7,7,3,2,3,7,4,4,0,3]},rotation:{x:Math.PI/2},position:{z:1}}),ge=i("CanvasTexture",{url:"hookAlpha"}),he=i("MeshBasicMaterial",{color:"rgb(53, 193, 221)",side:K,alphaMap:ge.vid,transparent:!0}),V=i("Mesh",{geometry:pe.vid,material:he.vid,visible:!1}),H=i("PlaneGeometry",{width:100,height:50,rotation:{x:Math.PI/2}}),me=i("CanvasTexture",{url:"treeTips"}),fe=i("MeshBasicMaterial",{alphaMap:me.vid,transparent:!0}),E=i("Mesh",{geometry:H.vid,material:fe.vid,position:{z:f+10,y:-r*d+20,x:r*d-50},visible:!1}),j=i("CSS3DPlane",{element:"treeGraph",width:1024,height:1024,scale:{x:.7,y:.7,z:.7},position:{z:f+10},visible:!1}),ye=i("CanvasTexture",{url:"arcTips"}),ue=i("MeshBasicMaterial",{alphaMap:ye.vid,transparent:!0}),L=i("Mesh",{geometry:H.vid,material:ue.vid,position:{z:f+120,y:-r*d+20,x:r*d-50},visible:!1}),M=i("CSS3DPlane",{element:"arcGraph",width:1024,height:1024,scale:{x:.7,y:.7,z:.7},position:{z:f+120},visible:!1}),be=i("Group",{children:[V.vid,E.vid,j.vid,L.vid,M.vid]}),B=6,T=10,D=5,Q=[],_=[];for(let e=0;e<=B*T-1;e+=1){const t=document.createElement("div");t.className="app-brick",t.innerHTML=`<span class="title">title:${e}</span>
        <span class="tips">tips:${e}</span>`,document.body.appendChild(t),S.registerResources({[`dom${e}`]:t});const o=te();Q.push(o);const n={x:T*(w+D)*(e%T/T)-T*(w+D)/2,y:B*(w+D)*(Math.floor(e/T)/B)-B*(w+D)/2,z:0},a=i("CSS3DPlane",{vid:o,element:`dom${e}`,width:R,height:w,position:n,click:[l.generateConfig("focusObject",{params:{target:o,space:"local",offset:{y:-850,z:500}},back:!1}),l.generateConfig("moveTo",{params:{target:be.vid,position:{x:n.x,y:n.y,z:n.z},duration:0}}),l.generateConfig("moveFromTo",{params:{target:M.vid,to:{x:0,y:0,z:f+120},delay:500}}),l.generateConfig("moveFromTo",{params:{target:E.vid,to:JSON.parse(JSON.stringify(E.position)),delay:500}}),l.generateConfig("moveFromTo",{params:{target:j.vid,to:JSON.parse(JSON.stringify(j.position)),delay:500}}),l.generateConfig("moveFromTo",{params:{target:L.vid,to:JSON.parse(JSON.stringify(L.position)),delay:500}}),l.generateConfig("moveFromTo",{params:{target:M.vid,to:JSON.parse(JSON.stringify(M.position)),delay:500}}),l.generateConfig("fadeObject",{params:{target:V.vid,direction:"in",delay:500}}),l.generateConfig("fadeObject",{params:{target:L.vid,direction:"in",delay:500}}),l.generateConfig("visibleObject",{params:{target:M.vid,visible:!1}}),l.generateConfig("visibleObject",{params:{target:M.vid,visible:!0,delay:500}}),l.generateConfig("fadeObject",{params:{target:E.vid,direction:"in",delay:500}}),l.generateConfig("visibleObject",{params:{target:j.vid,visible:!1}}),l.generateConfig("visibleObject",{params:{target:j.vid,visible:!0,delay:500}}),l.generateConfig("addClass",{params:{target:o,className:"app-brick-focus"}})]});_.push(a)}_.forEach(e=>{const t=l.generateConfig("addClass",{params:{target:Q.filter(o=>o!==e.vid),className:"app-brick-fade"}});e.click.push(t)});console.log(S);
